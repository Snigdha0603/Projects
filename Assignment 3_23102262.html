<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assignment_3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment 3_23102262_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment 3_23102262_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment 3_23102262_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment 3_23102262_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment 3_23102262_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment 3_23102262_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment 3_23102262_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment 3_23102262_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment 3_23102262_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment 3_23102262_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Assignment 3_23102262_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="Assignment 3_23102262_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="Assignment 3_23102262_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Assignment 3_23102262_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="Assignment 3_23102262_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Assignment 3_23102262_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="Assignment 3_23102262_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="Assignment 3_23102262_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="Assignment 3_23102262_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="Assignment 3_23102262_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="Assignment 3_23102262_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="Assignment 3_23102262_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="Assignment 3_23102262_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment_3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-automobile--sales-insurance-and-review-analysis" class="level1">
<h1>Automobile- Sales, Insurance and Review Analysis</h1>
<section id="sec-loading-dataset" class="level2" style="Dark Blue">
<h2 style="Dark Blue" class="anchored" data-anchor-id="sec-loading-dataset">Loading Dataset</h2>
<p>Loading the following dataset</p>
<ol type="1">
<li><p>Car_sales dataset from assignment 1 where we talked about the sales data.<br>
Kaggle link: <a href="https://www.kaggle.com/datasets/missionjee/car-sales-report" class="uri">https://www.kaggle.com/datasets/missionjee/car-sales-report</a></p></li>
<li><p>Insurance Claims dataset<br>
Kaggle Link: <a href="https://www.kaggle.com/datasets/buntyshah/auto-insurance-claims-data" class="uri">https://www.kaggle.com/datasets/buntyshah/auto-insurance-claims-data</a></p></li>
<li><p>Dataset including Reviews given by customers</p>
<p>Kaggle Link:<a href="https://www.kaggle.com/datasets/shreemunpranav/edmunds-car-review" class="uri">https://www.kaggle.com/datasets/shreemunpranav/edmunds-car-review</a></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Car_Sales<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/Snigdha/ireland/Class/Applied Analytics in Business and Society/Assignment 3/Car_Sales_new.xlsx"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Car_Sales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Insurance <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"D:/Snigdha/ireland/Class/Applied Analytics in Business and Society/Assignment 3/insurance_claims_new.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Insurance)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Review <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/Snigdha/ireland/Class/Applied Analytics in Business and Society/Assignment 3/Review_new.xlsx"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Review)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">Data Pre-processing</h2>
<p>Here we are converting the data into lowercase to help in joining the datasets using inner-join and composite key - “Company” &amp; “Model” of the car.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the columns to the same case</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Insurance<span class="sc">$</span>auto_make <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Insurance<span class="sc">$</span>auto_make)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Review<span class="sc">$</span>Company <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Review<span class="sc">$</span>Company)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Insurance<span class="sc">$</span>auto_model <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Insurance<span class="sc">$</span>auto_model)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Review<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Review<span class="sc">$</span>Model)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Car_Sales<span class="sc">$</span>Company <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Car_Sales<span class="sc">$</span>Company)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Car_Sales<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Car_Sales<span class="sc">$</span>Model)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(Car_Sales, Review, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Company"</span>, <span class="st">"Model"</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(merged_data)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(merged_data, Insurance, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Company"</span> <span class="ot">=</span> <span class="st">"auto_make"</span>, <span class="st">"Model"</span> <span class="ot">=</span> <span class="st">"auto_model"</span>), <span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [96 × 58] (S3: tbl_df/tbl/data.frame)
 $ Car_id                     : chr [1:96] "C_CND_000638" "C_CND_000638" "C_CND_000638" "C_CND_000638" ...
 $ Date.x                     : POSIXct[1:96], format: "2022-01-03" "2022-01-03" ...
 $ Gender                     : chr [1:96] "Male" "Male" "Male" "Male" ...
 $ Annual_Income              : num [1:96] 9e+05 9e+05 9e+05 9e+05 9e+05 9e+05 9e+05 9e+05 9e+05 9e+05 ...
 $ Dealer_Name                : chr [1:96] "Suburban Ford" "Suburban Ford" "Suburban Ford" "Suburban Ford" ...
 $ Company                    : chr [1:96] "nissan" "nissan" "nissan" "nissan" ...
 $ Model                      : chr [1:96] "pathfinder" "pathfinder" "pathfinder" "pathfinder" ...
 $ Engine                     : chr [1:96] "DoubleÃ‚Â&nbsp;Overhead Camshaft" "DoubleÃ‚Â&nbsp;Overhead Camshaft" "DoubleÃ‚Â&nbsp;Overhead Camshaft" "DoubleÃ‚Â&nbsp;Overhead Camshaft" ...
 $ Transmission               : chr [1:96] "Auto" "Auto" "Auto" "Auto" ...
 $ Color                      : chr [1:96] "Pale White" "Pale White" "Pale White" "Pale White" ...
 $ Price                      : num [1:96] 21001 21001 21001 21001 21001 ...
 $ Dealer_No                  : chr [1:96] "53546-9427" "53546-9427" "53546-9427" "53546-9427" ...
 $ Body_Style                 : chr [1:96] "SUV" "SUV" "SUV" "SUV" ...
 $ Phone                      : num [1:96] 7031083 7031083 7031083 7031083 7031083 ...
 $ Dealer_Region              : chr [1:96] "Janesville" "Janesville" "Janesville" "Janesville" ...
 $ Year                       : num [1:96] 2000 2000 2000 2000 2000 2000 2000 2000 2000 2000 ...
 $ Reviewer                   : chr [1:96] "azkimo" "azkimo" "azkimo" "azkimo" ...
 $ Date.y                     : chr [1:96] "02/11/2013" "02/11/2013" "02/11/2013" "02/11/2013" ...
 $ Title                      : chr [1:96] "Great SUV" "Great SUV" "Great SUV" "Great SUV" ...
 $ Rating                     : num [1:96] 3 3 3 3 3 3 3 3 3 3 ...
 $ Review                     : chr [1:96] "I bought my 2000 with 245000 miles on it for 1700.00. After replacing the cv joints, heater core, front struts,"| __truncated__ "I bought my 2000 with 245000 miles on it for 1700.00. After replacing the cv joints, heater core, front struts,"| __truncated__ "I bought my 2000 with 245000 miles on it for 1700.00. After replacing the cv joints, heater core, front struts,"| __truncated__ "I bought my 2000 with 245000 miles on it for 1700.00. After replacing the cv joints, heater core, front struts,"| __truncated__ ...
 $ months_as_customer         : int [1:96] 137 196 199 430 80 128 27 134 264 236 ...
 $ age                        : int [1:96] 34 39 37 59 25 32 28 30 41 38 ...
 $ policy_number              : int [1:96] 413978 143972 982871 691189 992145 547744 735822 843227 424862 873859 ...
 $ policy_bind_date           : chr [1:96] "04-06-2000" "02-08-1992" "27-07-1997" "10-01-2004" ...
 $ policy_state               : chr [1:96] "IN" "IN" "IN" "OH" ...
 $ policy_csl                 : chr [1:96] "250/500" "500/1000" "250/500" "250/500" ...
 $ policy_deductable          : int [1:96] 1000 2000 500 2000 2000 2000 2000 2000 500 1000 ...
 $ policy_annual_premium      : num [1:96] 1333 1476 1262 1327 1075 ...
 $ umbrella_limit             : int [1:96] 0 0 0 7000000 5000000 0 0 0 0 0 ...
 $ insured_zip                : int [1:96] 441716 477670 474615 477310 601112 443522 451560 613287 474801 612597 ...
 $ insured_sex                : chr [1:96] "MALE" "FEMALE" "MALE" "MALE" ...
 $ insured_education_level    : chr [1:96] "PhD" "High School" "JD" "MD" ...
 $ insured_occupation         : chr [1:96] "prof-specialty" "handlers-cleaners" "tech-support" "other-service" ...
 $ insured_hobbies            : chr [1:96] "board-games" "camping" "video-games" "bungie-jumping" ...
 $ insured_relationship       : chr [1:96] "husband" "own-child" "wife" "own-child" ...
 $ capital.gains              : int [1:96] 0 57000 48500 0 67700 0 0 0 55600 0 ...
 $ capital.loss               : int [1:96] -77000 -27300 0 0 -58400 -39300 -32500 0 0 -62500 ...
 $ incident_date              : chr [1:96] "13-01-2015" "22-02-2015" "08-01-2015" "03-01-2015" ...
 $ incident_type              : chr [1:96] "Multi-vehicle Collision" "Multi-vehicle Collision" "Single Vehicle Collision" "Multi-vehicle Collision" ...
 $ collision_type             : chr [1:96] "Front Collision" "Side Collision" "Front Collision" "Front Collision" ...
 $ incident_severity          : chr [1:96] "Minor Damage" "Major Damage" "Major Damage" "Minor Damage" ...
 $ authorities_contacted      : chr [1:96] "Police" "Police" "Ambulance" "Fire" ...
 $ incident_state             : chr [1:96] "NY" "VA" "NC" "NY" ...
 $ incident_city              : chr [1:96] "Springfield" "Columbus" "Columbus" "Riverwood" ...
 $ incident_location          : chr [1:96] "5846 Weaver Drive" "8101 3rd Ridge" "3422 Flute St" "5104 Francis Drive" ...
 $ incident_hour_of_the_day   : int [1:96] 0 8 4 19 5 0 10 19 4 16 ...
 $ number_of_vehicles_involved: int [1:96] 3 3 1 3 1 1 3 3 1 1 ...
 $ property_damage            : chr [1:96] "?" "?" "?" "?" ...
 $ bodily_injuries            : int [1:96] 0 2 0 0 2 1 0 0 1 0 ...
 $ witnesses                  : int [1:96] 0 0 3 3 0 0 2 2 0 1 ...
 $ police_report_available    : chr [1:96] "?" "NO" "NO" "YES" ...
 $ total_claim_amount         : int [1:96] 78650 60400 60170 81800 6930 59800 53600 47790 60390 66840 ...
 $ injury_claim               : int [1:96] 21450 6040 10940 16360 1260 5980 5360 5310 10980 16710 ...
 $ property_claim             : int [1:96] 7150 6040 10940 8180 630 5980 10720 5310 5490 5570 ...
 $ vehicle_claim              : int [1:96] 50050 48320 38290 57260 5040 47840 37520 37170 43920 44560 ...
 $ auto_year                  : int [1:96] 2012 2014 2011 1998 2013 1999 2001 2003 2010 1997 ...
 $ fraud_reported             : chr [1:96] "N" "N" "Y" "N" ...</code></pre>
</div>
</div>
<p>Loading Libraries for Modelling</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data manipulation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ ggplot2   3.4.4     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># For date manipulation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)        <span class="co"># For text mining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tm' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: NLP

Attaching package: 'NLP'

The following object is masked from 'package:ggplot2':

    annotate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data manipulation</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># For date manipulation</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels) <span class="co"># For topic modeling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'topicmodels' was built under R version 4.3.3</code></pre>
</div>
</div>
</section>
<section id="performing-eda" class="level2">
<h2 class="anchored" data-anchor-id="performing-eda">Performing EDA</h2>
<p>The “result” dataframe, comprising sales data, insurance data, and car reviews, underwent exploratory data analysis (EDA) to gain insights and prepare for subsequent analysis. Summary statistics offered a snapshot of the dataset’s characteristics, while visualizations like histograms and boxplots shed light on distributions and relationships. Handling missing values was recommended, and potential outliers in the ‘total_claim_amount’ variable were identified using boxplots and the interquartile range method. Variable transformations and class balance checks were suggested for improved modeling accuracy. Overall, the EDA process provided a comprehensive understanding of the dataset’s structure and key features, laying the groundwork for further analysis and modeling endeavors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set CRAN mirror</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the 'tm' package is installed; if not, install it</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"tm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tm"</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>, <span class="at">repos =</span> <span class="fu">getOption</span>(<span class="st">"repos"</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly")</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'plotly' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Car_id              Date.x                       Gender         
 Length:96          Min.   :2022-01-03 00:00:00   Length:96         
 Class :character   1st Qu.:2022-01-03 00:00:00   Class :character  
 Mode  :character   Median :2022-01-09 00:00:00   Mode  :character  
                    Mean   :2022-01-16 08:45:00                     
                    3rd Qu.:2022-02-07 00:00:00                     
                    Max.   :2022-02-10 00:00:00                     
 Annual_Income     Dealer_Name          Company             Model          
 Min.   :  13500   Length:96          Length:96          Length:96         
 1st Qu.:  13500   Class :character   Class :character   Class :character  
 Median : 715000   Mode  :character   Mode  :character   Mode  :character  
 Mean   : 549260                                                           
 3rd Qu.: 786750                                                           
 Max.   :2160000                                                           
    Engine          Transmission          Color               Price      
 Length:96          Length:96          Length:96          Min.   :13000  
 Class :character   Class :character   Class :character   1st Qu.:14000  
 Mode  :character   Mode  :character   Mode  :character   Median :21000  
                                                          Mean   :19542  
                                                          3rd Qu.:24000  
                                                          Max.   :31000  
  Dealer_No          Body_Style            Phone         Dealer_Region     
 Length:96          Length:96          Min.   :6174282   Length:96         
 Class :character   Class :character   1st Qu.:6457346   Class :character  
 Mode  :character   Mode  :character   Median :7031083   Mode  :character  
                                       Mean   :7024866                     
                                       3rd Qu.:7123129                     
                                       Max.   :8552255                     
      Year        Reviewer            Date.y             Title          
 Min.   :2000   Length:96          Length:96          Length:96         
 1st Qu.:2000   Class :character   Class :character   Class :character  
 Median :2000   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2000                                                           
 3rd Qu.:2000                                                           
 Max.   :2000                                                           
     Rating     Review          months_as_customer      age       
 Min.   :3   Length:96          Min.   :  1.0      Min.   :23.00  
 1st Qu.:3   Class :character   1st Qu.: 87.5      1st Qu.:30.00  
 Median :4   Mode  :character   Median :195.0      Median :37.00  
 Mean   :4                      Mean   :192.4      Mean   :38.24  
 3rd Qu.:5                      3rd Qu.:281.0      3rd Qu.:44.25  
 Max.   :5                      Max.   :451.0      Max.   :61.00  
 policy_number    policy_bind_date   policy_state        policy_csl       
 Min.   :107181   Length:96          Length:96          Length:96         
 1st Qu.:339472   Class :character   Class :character   Class :character  
 Median :514558   Mode  :character   Mode  :character   Mode  :character  
 Mean   :537032                                                           
 3rd Qu.:719508                                                           
 Max.   :992145                                                           
 policy_deductable policy_annual_premium umbrella_limit      insured_zip    
 Min.   : 500      Min.   : 714          Min.   :-1000000   Min.   :431531  
 1st Qu.: 500      1st Qu.:1079          1st Qu.:       0   1st Qu.:452766  
 Median :1000      Median :1254          Median :       0   Median :473845  
 Mean   :1135      Mean   :1227          Mean   :  718750   Mean   :512636  
 3rd Qu.:2000      3rd Qu.:1387          3rd Qu.:       0   3rd Qu.:606339  
 Max.   :2000      Max.   :1628          Max.   : 8000000   Max.   :620473  
 insured_sex        insured_education_level insured_occupation
 Length:96          Length:96               Length:96         
 Class :character   Class :character        Class :character  
 Mode  :character   Mode  :character        Mode  :character  
                                                              
                                                              
                                                              
 insured_hobbies    insured_relationship capital.gains    capital.loss   
 Length:96          Length:96            Min.   :    0   Min.   :-77600  
 Class :character   Class :character     1st Qu.:    0   1st Qu.:-52350  
 Mode  :character   Mode  :character     Median :    0   Median :-19600  
                                         Mean   :23818   Mean   :-26090  
                                         3rd Qu.:50050   3rd Qu.:     0  
                                         Max.   :87800   Max.   :     0  
 incident_date      incident_type      collision_type     incident_severity 
 Length:96          Length:96          Length:96          Length:96         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 authorities_contacted incident_state     incident_city      incident_location 
 Length:96             Length:96          Length:96          Length:96         
 Class :character      Class :character   Class :character   Class :character  
 Mode  :character      Mode  :character   Mode  :character   Mode  :character  
                                                                               
                                                                               
                                                                               
 incident_hour_of_the_day number_of_vehicles_involved property_damage   
 Min.   : 0.0             Min.   :1.000               Length:96         
 1st Qu.: 4.0             1st Qu.:1.000               Class :character  
 Median :10.5             Median :1.000               Mode  :character  
 Mean   :10.5             Mean   :1.854                                 
 3rd Qu.:15.0             3rd Qu.:3.000                                 
 Max.   :23.0             Max.   :4.000                                 
 bodily_injuries   witnesses     police_report_available total_claim_amount
 Min.   :0.000   Min.   :0.000   Length:96               Min.   :  2520    
 1st Qu.:0.000   1st Qu.:0.000   Class :character        1st Qu.: 41490    
 Median :1.000   Median :1.000   Mode  :character        Median : 59985    
 Mean   :1.021   Mean   :1.365                           Mean   : 52623    
 3rd Qu.:2.000   3rd Qu.:2.000                           3rd Qu.: 70810    
 Max.   :2.000   Max.   :3.000                           Max.   :107900    
  injury_claim   property_claim  vehicle_claim     auto_year   
 Min.   :    0   Min.   :    0   Min.   : 1960   Min.   :1995  
 1st Qu.: 3832   1st Qu.: 4358   1st Qu.:30413   1st Qu.:1999  
 Median : 6735   Median : 6435   Median :42210   Median :2005  
 Mean   : 7306   Mean   : 7149   Mean   :38168   Mean   :2005  
 3rd Qu.:10950   3rd Qu.:10355   3rd Qu.:52123   3rd Qu.:2010  
 Max.   :21450   Max.   :21580   Max.   :76400   Max.   :2015  
 fraud_reported    
 Length:96         
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot of 'total_claim_amount'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>boxplot_total_claim_amount <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> total_claim_amount)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Total Claim Amount"</span>, <span class="at">y =</span> <span class="st">"Total Claim Amount"</span>, <span class="at">x =</span> <span class="st">""</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot of 'age' by 'fraud_reported'</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>boxplot_age_fraud_reported <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> fraud_reported, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution by Fraud Reported"</span>, <span class="at">x =</span> <span class="st">"Fraud Reported"</span>, <span class="at">y =</span> <span class="st">"Age"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis of Policy Characteristics - Boxplot (Annual Premium by Policy State)</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>boxplot_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(<span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> policy_state, <span class="at">y =</span> policy_annual_premium)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()) <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Annual Premium by Policy State"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>boxplot_total_claim_amount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1f4fead16536ba93c952" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1f4fead16536ba93c952">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[78650,60400,60170,81800,6930,59800,53600,47790,60390,66840,3190,60600,3770,58800,75960,44280,45120,71680,6890,41490,65800,84500,6300,51030,68310,52800,107900,61380,90970,63120,58140,7480,31350,32800,67200,68760,74900,94560,61270,64800,56000,44280,45120,71680,6890,41490,65800,84500,6300,51030,6600,76120,5170,6200,86060,94160,31700,50380,76920,3190,71440,66880,73400,66950,87960,4950,27700,9020,84720,73500,69100,55440,64800,5580,41850,70400,60750,62920,8640,62300,36300,99320,6500,2520,73700,70600,44190,87100,78100,44110,55600,59520,53190,48290,63580,49800],"hoverinfo":"y","type":"box","fillcolor":"rgba(135,206,235,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(0,0,0,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":13.881278538812786,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot of Total Claim Amount","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,1.6000000000000001],"tickmode":"array","ticktext":[""],"tickvals":[1],"categoryorder":"array","categoryarray":[""],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2749,113169],"tickmode":"array","ticktext":["0","30000","60000","90000"],"tickvals":[0,30000.000000000004,60000,90000],"categoryorder":"array","categoryarray":["0","30000","60000","90000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total Claim Amount","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c885b546f90":{"x":{},"y":{},"type":"box"}},"cur_data":"4c885b546f90","visdat":{"4c885b546f90":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>boxplot_age_fraud_reported</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e45135a054dbaaa7d32d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e45135a054dbaaa7d32d">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[34,39,44,59,25,57,37,47,30,38,27,48,34,34,54,27,26,28,40,37,44,27,37,25,29,27,41,29,44,42,33,57,33,47,30,23,46,40,32,35,30,48,45,41,35,25,45,49,30,29,43,46,38,42,43,37,59,54,28,39,50,39,33,54,29,37,43,41,28,35,25,28,26,30,53,53,28,41,30,33,25,58,27,32,45,43,46,34,38,42,39,31,61,37,58,27],"hoverinfo":"y","type":"box","fillcolor":"rgba(144,238,144,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Age Distribution by Fraud Reported","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["N","Y"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["N","Y"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Fraud Reported","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[21.100000000000001,62.899999999999999],"tickmode":"array","ticktext":["30","40","50","60"],"tickvals":[30,40,50,60],"categoryorder":"array","categoryarray":["30","40","50","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Age","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c88145f3c2a":{"x":{},"y":{},"type":"box"}},"cur_data":"4c88145f3c2a","visdat":{"4c88145f3c2a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>boxplot_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b3449c2cf11afd1bb901" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b3449c2cf11afd1bb901">{"x":{"data":[{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[1333.3499999999999,1475.73,1262.0799999999999,1226.8299999999999,1212,1123.8900000000001,1371.78,1386.9300000000001,966.25999999999999,956.69000000000005,1242.02,1538.5999999999999,1056.71,1354.5,1337.9200000000001,1363.77,1226.8299999999999,1344.3599999999999,1072.6199999999999,765.63999999999999,1386.9300000000001,1397.6700000000001,1421.5899999999999,942.50999999999999,1331.6900000000001,1302.4000000000001,770.75999999999999,1437.8800000000001,1322.0999999999999,1472.77,999.51999999999998,969.88,1618.6500000000001,1155.55,1411.3,1257,802.24000000000001,768.90999999999997,1443.3199999999999,1434.51,1282.9300000000001,1105.49,1628,994.74000000000001,1238.6500000000001,1080.1300000000001,1326.6199999999999,1338.54,1166.54,1075.71,972.5,1483.9100000000001,889.13,1203.24,1267.8099999999999,1403.9000000000001,990.98000000000002,1512.5799999999999,1080.1300000000001,1332.0699999999999,1075.4100000000001,1221.1700000000001,1264.77,1221.1700000000001,1212.1199999999999,791.47000000000003,1193.45,1251.1600000000001,1384.51,1340.5599999999999,1401.2,1075.1800000000001,1348.8299999999999,1316.6300000000001,791.47000000000003,1474.1700000000001,1611.8299999999999,1232.72,968.74000000000001,1442.99,1523.1700000000001,924.72000000000003,1384.51,1401.2,1168.2,1085.03,1316.6300000000001,1111.72,1540.1900000000001,1482.1400000000001,1409.0599999999999,714.02999999999997,1117.4200000000001,1168.2,1237.8800000000001,903.32000000000005],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["IL","IN","OH"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["IL","IN","OH"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"policy_state","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[668.33150000000001,1673.6985],"tickmode":"array","ticktext":["750","1000","1250","1500"],"tickvals":[750,1000,1250,1500],"categoryorder":"array","categoryarray":["750","1000","1250","1500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"policy_annual_premium","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative","title":"Annual Premium by Policy State"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c8818153249":{"x":{},"y":{},"type":"box"}},"cur_data":"4c8818153249","visdat":{"4c8818153249":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handling missing values</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Car_id                      Date.x 
                          0                           0 
                     Gender               Annual_Income 
                          0                           0 
                Dealer_Name                     Company 
                          0                           0 
                      Model                      Engine 
                          0                           0 
               Transmission                       Color 
                          0                           0 
                      Price                   Dealer_No 
                          0                           0 
                 Body_Style                       Phone 
                          0                           0 
              Dealer_Region                        Year 
                          0                           0 
                   Reviewer                      Date.y 
                          0                           0 
                      Title                      Rating 
                          0                           0 
                     Review          months_as_customer 
                          0                           0 
                        age               policy_number 
                          0                           0 
           policy_bind_date                policy_state 
                          0                           0 
                 policy_csl           policy_deductable 
                          0                           0 
      policy_annual_premium              umbrella_limit 
                          0                           0 
                insured_zip                 insured_sex 
                          0                           0 
    insured_education_level          insured_occupation 
                          0                           0 
            insured_hobbies        insured_relationship 
                          0                           0 
              capital.gains                capital.loss 
                          0                           0 
              incident_date               incident_type 
                          0                           0 
             collision_type           incident_severity 
                          0                           0 
      authorities_contacted              incident_state 
                          0                           0 
              incident_city           incident_location 
                          0                           0 
   incident_hour_of_the_day number_of_vehicles_involved 
                          0                           0 
            property_damage             bodily_injuries 
                          0                           0 
                  witnesses     police_report_available 
                          0                           0 
         total_claim_amount                injury_claim 
                          0                           0 
             property_claim               vehicle_claim 
                          0                           0 
                  auto_year              fraud_reported 
                          0                           0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to detect outliers using IQR method</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>detect_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  iqr <span class="ot">&lt;-</span> q3 <span class="sc">-</span> q1</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  lower_bound <span class="ot">&lt;-</span> q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  upper_bound <span class="ot">&lt;-</span> q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> x <span class="sc">&gt;</span> upper_bound)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Outlier detection for 'total_claim_amount'</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>outliers_total_claim_amount <span class="ot">&lt;-</span> <span class="fu">detect_outliers</span>(result<span class="sc">$</span>total_claim_amount)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>outliers_total_claim_amount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> result</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis of Insured Occupations - Bar plot (Top 10 occupations)</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>top_occupations <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">table</span>(dataset<span class="sc">$</span>insured_occupation), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">10</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>barplot_plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">names</span>(top_occupations), <span class="at">y =</span> top_occupations, <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>barplot_plot <span class="ot">&lt;-</span> barplot_plot <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Top 10 Insured Occupations"</span>, <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Occupation"</span>), <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Count"</span>))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis of Claim Characteristics - Histogram (Total Claim Amount)</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>histogram_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(<span class="fu">ggplot</span>(dataset, <span class="fu">aes</span>(<span class="at">x =</span> total_claim_amount)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1000</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Distribution of Total Claim Amount"</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis of Demographic Data - Pie chart (Gender Distribution)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>gender_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(dataset<span class="sc">$</span>Gender)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>pie_plot_gender <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">labels =</span> <span class="fu">names</span>(gender_counts), <span class="at">values =</span> gender_counts, <span class="at">type =</span> <span class="st">"pie"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"lightblue"</span>)))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>pie_plot_gender <span class="ot">&lt;-</span> pie_plot_gender <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Gender Distribution"</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis of Fraud Cases - Pie chart</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>fraud_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(dataset<span class="sc">$</span>fraud_reported)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>pie_plot_fraud <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">labels =</span> <span class="fu">names</span>(fraud_counts), <span class="at">values =</span> fraud_counts, <span class="at">type =</span> <span class="st">"pie"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"lightgreen"</span>)))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>pie_plot_fraud <span class="ot">&lt;-</span> pie_plot_fraud <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Fraud Reported"</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>barplot_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-172322461ba9e97eddc4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-172322461ba9e97eddc4">{"x":{"visdat":{"4c8869ef54ea":["function () ","plotlyVisDat"]},"cur_data":"4c8869ef54ea","attrs":{"4c8869ef54ea":{"x":["machine-op-inspct","exec-managerial","prof-specialty","transport-moving","adm-clerical","protective-serv","armed-forces","other-service","priv-house-serv","craft-repair"],"y":[12,11,10,10,8,7,6,6,6,5],"marker":{"color":"lightgreen"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Top 10 Insured Occupations","xaxis":{"domain":[0,1],"automargin":true,"title":"Occupation","type":"category","categoryorder":"array","categoryarray":["adm-clerical","armed-forces","craft-repair","exec-managerial","machine-op-inspct","other-service","priv-house-serv","prof-specialty","protective-serv","transport-moving"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["machine-op-inspct","exec-managerial","prof-specialty","transport-moving","adm-clerical","protective-serv","armed-forces","other-service","priv-house-serv","craft-repair"],"y":[12,11,10,10,8,7,6,6,6,5],"marker":{"color":"lightgreen","line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>boxplot_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-57bac55b8872a183cc03" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-57bac55b8872a183cc03">{"x":{"data":[{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[1333.3499999999999,1475.73,1262.0799999999999,1226.8299999999999,1212,1123.8900000000001,1371.78,1386.9300000000001,966.25999999999999,956.69000000000005,1242.02,1538.5999999999999,1056.71,1354.5,1337.9200000000001,1363.77,1226.8299999999999,1344.3599999999999,1072.6199999999999,765.63999999999999,1386.9300000000001,1397.6700000000001,1421.5899999999999,942.50999999999999,1331.6900000000001,1302.4000000000001,770.75999999999999,1437.8800000000001,1322.0999999999999,1472.77,999.51999999999998,969.88,1618.6500000000001,1155.55,1411.3,1257,802.24000000000001,768.90999999999997,1443.3199999999999,1434.51,1282.9300000000001,1105.49,1628,994.74000000000001,1238.6500000000001,1080.1300000000001,1326.6199999999999,1338.54,1166.54,1075.71,972.5,1483.9100000000001,889.13,1203.24,1267.8099999999999,1403.9000000000001,990.98000000000002,1512.5799999999999,1080.1300000000001,1332.0699999999999,1075.4100000000001,1221.1700000000001,1264.77,1221.1700000000001,1212.1199999999999,791.47000000000003,1193.45,1251.1600000000001,1384.51,1340.5599999999999,1401.2,1075.1800000000001,1348.8299999999999,1316.6300000000001,791.47000000000003,1474.1700000000001,1611.8299999999999,1232.72,968.74000000000001,1442.99,1523.1700000000001,924.72000000000003,1384.51,1401.2,1168.2,1085.03,1316.6300000000001,1111.72,1540.1900000000001,1482.1400000000001,1409.0599999999999,714.02999999999997,1117.4200000000001,1168.2,1237.8800000000001,903.32000000000005],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["IL","IN","OH"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["IL","IN","OH"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"policy_state","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[668.33150000000001,1673.6985],"tickmode":"array","ticktext":["750","1000","1250","1500"],"tickvals":[750,1000,1250,1500],"categoryorder":"array","categoryarray":["750","1000","1250","1500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"policy_annual_premium","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative","title":"Annual Premium by Policy State"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c8818153249":{"x":{},"y":{},"type":"box"}},"cur_data":"4c8818153249","visdat":{"4c8818153249":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>histogram_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d8c18143a8b549ef9fa0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d8c18143a8b549ef9fa0">{"x":{"data":[{"orientation":"v","width":[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000,61000,62000,63000,64000,65000,66000,67000,68000,69000,70000,71000,72000,73000,74000,75000,76000,77000,78000,79000,80000,81000,82000,83000,84000,85000,86000,87000,88000,89000,90000,91000,92000,93000,94000,95000,96000,97000,98000,99000,100000,101000,102000,103000,104000,105000,106000,107000,108000],"y":[3,1,2,5,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,1,0,0,0,0,2,1,0,4,2,0,0,2,0,2,2,0,2,1,1,2,0,1,1,5,4,1,2,1,2,2,4,1,2,1,2,2,2,1,1,2,1,1,1,0,0,1,0,2,1,1,1,1,0,0,1,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,1],"text":["count: 3<br />total_claim_amount:   3000","count: 1<br />total_claim_amount:   4000","count: 2<br />total_claim_amount:   5000","count: 5<br />total_claim_amount:   6000","count: 5<br />total_claim_amount:   7000","count: 0<br />total_claim_amount:   8000","count: 2<br />total_claim_amount:   9000","count: 0<br />total_claim_amount:  10000","count: 0<br />total_claim_amount:  11000","count: 0<br />total_claim_amount:  12000","count: 0<br />total_claim_amount:  13000","count: 0<br />total_claim_amount:  14000","count: 0<br />total_claim_amount:  15000","count: 0<br />total_claim_amount:  16000","count: 0<br />total_claim_amount:  17000","count: 0<br />total_claim_amount:  18000","count: 0<br />total_claim_amount:  19000","count: 0<br />total_claim_amount:  20000","count: 0<br />total_claim_amount:  21000","count: 0<br />total_claim_amount:  22000","count: 0<br />total_claim_amount:  23000","count: 0<br />total_claim_amount:  24000","count: 0<br />total_claim_amount:  25000","count: 0<br />total_claim_amount:  26000","count: 0<br />total_claim_amount:  27000","count: 1<br />total_claim_amount:  28000","count: 0<br />total_claim_amount:  29000","count: 0<br />total_claim_amount:  30000","count: 1<br />total_claim_amount:  31000","count: 1<br />total_claim_amount:  32000","count: 1<br />total_claim_amount:  33000","count: 0<br />total_claim_amount:  34000","count: 0<br />total_claim_amount:  35000","count: 1<br />total_claim_amount:  36000","count: 0<br />total_claim_amount:  37000","count: 0<br />total_claim_amount:  38000","count: 0<br />total_claim_amount:  39000","count: 0<br />total_claim_amount:  40000","count: 2<br />total_claim_amount:  41000","count: 1<br />total_claim_amount:  42000","count: 0<br />total_claim_amount:  43000","count: 4<br />total_claim_amount:  44000","count: 2<br />total_claim_amount:  45000","count: 0<br />total_claim_amount:  46000","count: 0<br />total_claim_amount:  47000","count: 2<br />total_claim_amount:  48000","count: 0<br />total_claim_amount:  49000","count: 2<br />total_claim_amount:  50000","count: 2<br />total_claim_amount:  51000","count: 0<br />total_claim_amount:  52000","count: 2<br />total_claim_amount:  53000","count: 1<br />total_claim_amount:  54000","count: 1<br />total_claim_amount:  55000","count: 2<br />total_claim_amount:  56000","count: 0<br />total_claim_amount:  57000","count: 1<br />total_claim_amount:  58000","count: 1<br />total_claim_amount:  59000","count: 5<br />total_claim_amount:  60000","count: 4<br />total_claim_amount:  61000","count: 1<br />total_claim_amount:  62000","count: 2<br />total_claim_amount:  63000","count: 1<br />total_claim_amount:  64000","count: 2<br />total_claim_amount:  65000","count: 2<br />total_claim_amount:  66000","count: 4<br />total_claim_amount:  67000","count: 1<br />total_claim_amount:  68000","count: 2<br />total_claim_amount:  69000","count: 1<br />total_claim_amount:  70000","count: 2<br />total_claim_amount:  71000","count: 2<br />total_claim_amount:  72000","count: 2<br />total_claim_amount:  73000","count: 1<br />total_claim_amount:  74000","count: 1<br />total_claim_amount:  75000","count: 2<br />total_claim_amount:  76000","count: 1<br />total_claim_amount:  77000","count: 1<br />total_claim_amount:  78000","count: 1<br />total_claim_amount:  79000","count: 0<br />total_claim_amount:  80000","count: 0<br />total_claim_amount:  81000","count: 1<br />total_claim_amount:  82000","count: 0<br />total_claim_amount:  83000","count: 2<br />total_claim_amount:  84000","count: 1<br />total_claim_amount:  85000","count: 1<br />total_claim_amount:  86000","count: 1<br />total_claim_amount:  87000","count: 1<br />total_claim_amount:  88000","count: 0<br />total_claim_amount:  89000","count: 0<br />total_claim_amount:  90000","count: 1<br />total_claim_amount:  91000","count: 0<br />total_claim_amount:  92000","count: 0<br />total_claim_amount:  93000","count: 1<br />total_claim_amount:  94000","count: 1<br />total_claim_amount:  95000","count: 0<br />total_claim_amount:  96000","count: 0<br />total_claim_amount:  97000","count: 0<br />total_claim_amount:  98000","count: 1<br />total_claim_amount:  99000","count: 0<br />total_claim_amount: 100000","count: 0<br />total_claim_amount: 101000","count: 0<br />total_claim_amount: 102000","count: 0<br />total_claim_amount: 103000","count: 0<br />total_claim_amount: 104000","count: 0<br />total_claim_amount: 105000","count: 0<br />total_claim_amount: 106000","count: 0<br />total_claim_amount: 107000","count: 1<br />total_claim_amount: 108000"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(173,216,230,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":31.415525114155255},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2800,113800],"tickmode":"array","ticktext":["0","30000","60000","90000"],"tickvals":[0,30000,59999.999999999993,90000],"categoryorder":"array","categoryarray":["0","30000","60000","90000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"total_claim_amount","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.25,5.25],"tickmode":"array","ticktext":["0","1","2","3","4","5"],"tickvals":[0,1,2,3,4,5],"categoryorder":"array","categoryarray":["0","1","2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative","title":"Distribution of Total Claim Amount"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c884d8a140e":{"x":{},"type":"bar"}},"cur_data":"4c884d8a140e","visdat":{"4c884d8a140e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pie_plot_gender</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-56cdf89530b57ee78a3c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-56cdf89530b57ee78a3c">{"x":{"visdat":{"4c8836b32ee3":["function () ","plotlyVisDat"]},"cur_data":"4c8836b32ee3","attrs":{"4c8836b32ee3":{"labels":["Female","Male"],"values":[18,78],"marker":{"colors":["pink","lightblue"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Gender Distribution","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Female","Male"],"values":[18,78],"marker":{"color":"rgba(31,119,180,1)","colors":["pink","lightblue"],"line":{"color":"rgba(255,255,255,1)"}},"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pie_plot_fraud</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-113e6c4d5abfcf3f2575" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-113e6c4d5abfcf3f2575">{"x":{"visdat":{"4c881dec2237":["function () ","plotlyVisDat"]},"cur_data":"4c881dec2237","attrs":{"4c881dec2237":{"labels":["N","Y"],"values":[70,26],"marker":{"colors":["red","lightgreen"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Fraud Reported","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["N","Y"],"values":[70,26],"marker":{"color":"rgba(31,119,180,1)","colors":["red","lightgreen"],"line":{"color":"rgba(255,255,255,1)"}},"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive Bar Plot of Incident Types</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>incident_type_plot <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(incident_type) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>incident_type, <span class="at">y =</span> <span class="sc">~</span>n, <span class="at">type =</span> <span class="st">'bar'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Distribution of Incident Types"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Incident Type"</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Count"</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive Pie Chart of Incident Severity</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>incident_severity_plot <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(incident_severity) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(<span class="at">labels =</span> <span class="sc">~</span>incident_severity, <span class="at">values =</span> <span class="sc">~</span>n, <span class="at">type =</span> <span class="st">'pie'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Distribution of Incident Severity"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>incident_type_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-77be752ca9e708e88485" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-77be752ca9e708e88485">{"x":{"visdat":{"4c88589257f":["function () ","plotlyVisDat"]},"cur_data":"4c88589257f","attrs":{"4c88589257f":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Incident Types","xaxis":{"domain":[0,1],"automargin":true,"title":"Incident Type","type":"category","categoryorder":"array","categoryarray":["Multi-vehicle Collision","Parked Car","Single Vehicle Collision","Vehicle Theft"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Multi-vehicle Collision","Parked Car","Single Vehicle Collision","Vehicle Theft"],"y":[42,4,36,14],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>incident_severity_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-14a466d66af42b8fadef" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-14a466d66af42b8fadef">{"x":{"visdat":{"4c881a86b8d":["function () ","plotlyVisDat"]},"cur_data":"4c881a86b8d","attrs":{"4c881a86b8d":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Incident Severity","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Major Damage","Minor Damage","Total Loss","Trivial Damage"],"values":[30,34,24,8],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="quantitative-analysis" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-analysis">Quantitative Analysis:</h2>
</section>
<section id="modelling" class="level2">
<h2 class="anchored" data-anchor-id="modelling">Modelling</h2>
<p><br>
The provided code snippet performs a generalized linear model (GLM) analysis on the “result” dataframe, which combines sales data, insurance data, and car reviews. Initially, the independent variables (predictors) relevant for the analysis are defined, encompassing various attributes such as gender, annual income, age, and incident-related information. These variables are then filtered from the dataframe, and categorical variables are converted to factors to prepare the data for modeling.</p>
<p>Next, a GLM model is fitted using the Gaussian family and the total claim amount as the response variable. This model aims to explore the relationship between the predictors and the total claim amount, considering the various factors and attributes within the dataset. Finally, a summary of the GLM model is displayed, providing insights into the coefficients, significance levels, and goodness of fit metrics.</p>
<p>The result received is a tibble containing 96 rows and 58 columns, representing the combined dataset’s observations and variables. It includes diverse information such as car details, insurance information, reviewer details, incident characteristics, and various other attributes related to each observation. The data appears to be well-structured and rich, offering ample opportunities for further analysis and exploration.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tm")</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("topicmodels")</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'result' is your dataframe</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define independent variables (predictors)</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>independent_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Annual_Income"</span>, <span class="st">"age"</span>, <span class="st">"policy_annual_premium"</span>, </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"months_as_customer"</span>, <span class="st">"policy_deductable"</span>, <span class="st">"capital.gains"</span>, </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"capital.loss"</span>, <span class="st">"incident_hour_of_the_day"</span>, <span class="st">"number_of_vehicles_involved"</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"bodily_injuries"</span>, <span class="st">"witnesses"</span>, <span class="st">"total_claim_amount"</span>, </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"policy_state"</span>, <span class="st">"incident_type"</span>, <span class="st">"collision_type"</span>, </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"incident_severity"</span>, <span class="st">"authorities_contacted"</span>, <span class="st">"incident_state"</span>, </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"property_damage"</span>, <span class="st">"insured_sex"</span>, <span class="st">"insured_education_level"</span>, </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"insured_occupation"</span>, <span class="st">"insured_hobbies"</span>, <span class="st">"insured_relationship"</span>, </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"police_report_available"</span>, <span class="st">"fraud_reported"</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataframe to include only relevant variables</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>glm_data <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(independent_vars))</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical variables to factors</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>categorical_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"policy_state"</span>, <span class="st">"incident_type"</span>, <span class="st">"collision_type"</span>, </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"incident_severity"</span>, <span class="st">"authorities_contacted"</span>, <span class="st">"incident_state"</span>, </span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"property_damage"</span>, <span class="st">"insured_sex"</span>, <span class="st">"insured_education_level"</span>, </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"insured_occupation"</span>, <span class="st">"insured_hobbies"</span>, <span class="st">"insured_relationship"</span>, </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"police_report_available"</span>, <span class="st">"fraud_reported"</span>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>glm_data[categorical_vars] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(glm_data[categorical_vars], as.factor)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the GLM model</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(total_claim_amount <span class="sc">~</span> ., <span class="at">data =</span> glm_data, <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary of the model</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = total_claim_amount ~ ., family = gaussian(), data = glm_data)

Coefficients: (1 not defined because of singularities)
                                        Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)                           -2.047e+04  5.076e+04  -0.403  0.69286   
GenderMale                            -1.671e+04  2.044e+04  -0.818  0.42721   
Annual_Income                          6.846e-04  2.524e-03   0.271  0.79014   
age                                    2.991e+02  8.196e+02   0.365  0.72058   
policy_annual_premium                 -2.832e+01  1.522e+01  -1.860  0.08400 . 
months_as_customer                    -3.400e+01  6.727e+01  -0.505  0.62111   
policy_deductable                      2.845e+00  5.122e+00   0.555  0.58732   
capital.gains                          4.021e-01  1.205e-01   3.336  0.00490 **
capital.loss                           7.678e-02  1.169e-01   0.657  0.52187   
incident_hour_of_the_day               1.357e+03  1.025e+03   1.324  0.20680   
number_of_vehicles_involved            2.324e+04  1.272e+04   1.828  0.08898 . 
bodily_injuries                        1.198e+04  4.544e+03   2.637  0.01953 * 
witnesses                             -1.327e+03  2.067e+03  -0.642  0.53117   
policy_stateIN                         5.832e+03  5.265e+03   1.108  0.28668   
policy_stateOH                         1.688e+04  9.836e+03   1.716  0.10824   
incident_typeParked Car               -2.660e+03  3.292e+04  -0.081  0.93675   
incident_typeSingle Vehicle Collision  4.609e+04  2.337e+04   1.972  0.06866 . 
incident_typeVehicle Theft            -1.623e+04  3.234e+04  -0.502  0.62356   
collision_typeFront Collision         -3.170e+03  8.023e+03  -0.395  0.69875   
collision_typeRear Collision          -2.314e+03  9.724e+03  -0.238  0.81539   
collision_typeSide Collision                  NA         NA      NA       NA   
incident_severityMinor Damage          3.490e+03  7.995e+03   0.436  0.66916   
incident_severityTotal Loss            5.674e+03  9.897e+03   0.573  0.57556   
incident_severityTrivial Damage        2.228e+04  1.246e+04   1.788  0.09551 . 
authorities_contactedFire              3.379e+03  1.571e+04   0.215  0.83275   
authorities_contactedNone             -3.555e+03  2.088e+04  -0.170  0.86720   
authorities_contactedOther            -2.433e+04  1.411e+04  -1.725  0.10653   
authorities_contactedPolice           -1.081e+04  1.205e+04  -0.897  0.38508   
incident_stateNY                       1.750e+04  1.011e+04   1.731  0.10539   
incident_stateOH                       2.770e+04  3.203e+04   0.865  0.40182   
incident_statePA                      -1.408e+04  1.423e+04  -0.989  0.33937   
incident_stateSC                      -4.863e+03  1.662e+04  -0.293  0.77409   
incident_stateVA                       3.899e+03  1.072e+04   0.364  0.72161   
incident_stateWV                       8.871e+03  1.182e+04   0.751  0.46518   
property_damageNO                     -1.108e+04  8.133e+03  -1.362  0.19468   
property_damageYES                     7.459e+03  5.521e+03   1.351  0.19811   
insured_sexMALE                        1.556e+04  7.899e+03   1.970  0.06896 . 
insured_education_levelCollege        -5.984e+03  1.038e+04  -0.577  0.57325   
insured_education_levelHigh School     4.740e+02  1.245e+04   0.038  0.97018   
insured_education_levelJD             -1.255e+04  1.399e+04  -0.897  0.38475   
insured_education_levelMasters         2.578e+03  8.920e+03   0.289  0.77676   
insured_education_levelMD              9.161e+03  8.609e+03   1.064  0.30531   
insured_education_levelPhD            -3.471e+03  1.055e+04  -0.329  0.74702   
insured_occupationarmed-forces        -2.482e+04  2.873e+04  -0.864  0.40221   
insured_occupationcraft-repair        -4.559e+04  1.873e+04  -2.434  0.02895 * 
insured_occupationexec-managerial     -1.428e+04  1.279e+04  -1.117  0.28277   
insured_occupationfarming-fishing      3.091e+04  2.313e+04   1.336  0.20279   
insured_occupationhandlers-cleaners   -4.731e+04  3.483e+04  -1.358  0.19582   
insured_occupationmachine-op-inspct   -1.767e+04  1.674e+04  -1.056  0.30894   
insured_occupationother-service       -2.170e+04  1.493e+04  -1.453  0.16829   
insured_occupationpriv-house-serv     -3.072e+04  2.303e+04  -1.334  0.20347   
insured_occupationprof-specialty       3.413e+03  1.260e+04   0.271  0.79050   
insured_occupationprotective-serv     -5.089e+04  1.663e+04  -3.060  0.00847 **
insured_occupationsales               -2.904e+04  2.753e+04  -1.055  0.30931   
insured_occupationtech-support         7.136e+03  2.102e+04   0.340  0.73923   
insured_occupationtransport-moving    -8.462e+03  2.047e+04  -0.413  0.68560   
insured_hobbiesbasketball              1.020e+04  1.461e+04   0.698  0.49653   
insured_hobbiesboard-games             5.182e+04  2.204e+04   2.351  0.03388 * 
insured_hobbiesbungie-jumping          1.710e+04  2.127e+04   0.804  0.43485   
insured_hobbiescamping                 5.184e+04  3.138e+04   1.652  0.12080   
insured_hobbieschess                   1.717e+04  3.716e+04   0.462  0.65119   
insured_hobbiescross-fit               1.885e+04  2.514e+04   0.750  0.46567   
insured_hobbiesdancing                -2.282e+03  1.914e+04  -0.119  0.90680   
insured_hobbiesexercise                8.996e+03  1.554e+04   0.579  0.57175   
insured_hobbiesgolf                    2.509e+04  1.372e+04   1.829  0.08883 . 
insured_hobbieshiking                  1.333e+04  2.081e+04   0.641  0.53217   
insured_hobbieskayaking                4.657e+04  2.251e+04   2.068  0.05760 . 
insured_hobbiesmovies                  5.695e+04  1.836e+04   3.102  0.00780 **
insured_hobbiespaintball               4.729e+04  1.819e+04   2.600  0.02099 * 
insured_hobbiespolo                    5.389e+03  2.165e+04   0.249  0.80705   
insured_hobbiesreading                 2.203e+04  1.788e+04   1.232  0.23836   
insured_hobbiesskydiving               2.447e+04  2.776e+04   0.881  0.39305   
insured_hobbiessleeping                1.805e+04  2.403e+04   0.751  0.46495   
insured_hobbiesvideo-games            -6.473e+03  2.416e+04  -0.268  0.79266   
insured_hobbiesyachting               -1.633e+03  1.478e+04  -0.110  0.91359   
insured_relationshipnot-in-family      5.572e+02  7.350e+03   0.076  0.94065   
insured_relationshipother-relative     8.797e+03  1.278e+04   0.689  0.50236   
insured_relationshipown-child         -2.028e+03  1.244e+04  -0.163  0.87276   
insured_relationshipunmarried          7.291e+03  9.525e+03   0.765  0.45672   
insured_relationshipwife               1.013e+04  9.754e+03   1.038  0.31672   
police_report_availableNO             -4.725e+02  5.922e+03  -0.080  0.93754   
police_report_availableYES             3.096e+03  7.556e+03   0.410  0.68822   
fraud_reportedY                        1.757e+04  9.222e+03   1.905  0.07757 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 61621474)

    Null deviance: 6.9881e+10  on 95  degrees of freedom
Residual deviance: 8.6270e+08  on 14  degrees of freedom
AIC: 1975.5

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>The output is from a generalized linear model (GLM) fitted to the data using the Gaussian family. Each row represents a predictor variable, with corresponding estimates, standard errors, t-values, and p-values. The estimates indicate the expected change in the response variable for a one-unit change in the predictor, holding other predictors constant. The t-values and associated p-values assess the significance of each predictor’s effect on the response variable. Significance is determined based on the p-values, with smaller values indicating stronger evidence against the null hypothesis. Additionally, the null and residual deviance values provide insights into the goodness of fit of the model. Lower residual deviance values suggest a better fit, indicating that the model explains a larger proportion of the variability in the data. The Akaike Information Criterion (AIC) is used to compare the relative quality of different models, with lower values indicating better-fitting models. Finally, the number of Fisher Scoring iterations indicates the number of iterations required to fit the model. Overall, this output helps assess the significance of predictor variables and the overall fit of the GLM to the data..</p>
</section>
<section id="qualitative-analysis" class="level2">
<h2 class="anchored" data-anchor-id="qualitative-analysis">Qualitative Analysis:</h2>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
<p><br>
The sentiment analysis conducted on the dataset aimed to assess the sentiment expressed in the reviews provided for different car models from various companies. The output provides a summary of the sentiment scores assigned to each car model within their respective companies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidytext", dependencies = TRUE)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidytext' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("devtools")  # Install devtools package if you haven't already</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("trinker/afinn")</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("textdata")</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(textdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'textdata' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the path to the AFINN lexicon file</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>afinn_file <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/fnielsen/afinn/master/afinn/data/AFINN-111.txt"</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the AFINN lexicon into a data frame</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>afinn <span class="ot">&lt;-</span> <span class="fu">read.table</span>(afinn_file, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span><span class="cn">FALSE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"word"</span>, <span class="st">"value"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: EOF within quoted string</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,
: number of items read is not a multiple of the number of columns</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally, you can inspect the structure of the AFINN lexicon data frame</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(afinn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   340 obs. of  2 variables:
 $ word : chr  "abandon" "abandoned" "abandons" "abducted" ...
 $ value: int  -2 -2 -2 -2 -2 -2 -3 -3 -3 -3 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>afinn <span class="ot">&lt;-</span> <span class="fu">get_sentiments</span>(<span class="st">"afinn"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize the text data</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>tokenized_data <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, Review)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform sentiment scoring using the AFINN lexicon</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>sentiment_scores <span class="ot">&lt;-</span> tokenized_data <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(afinn, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Company, Model) <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sentiment_score =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Company'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the sentiment scores</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sentiment_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Company    Model      sentiment_score
  &lt;chr&gt;      &lt;chr&gt;                &lt;dbl&gt;
1 chevrolet  malibu                  51
2 honda      accord                -126
3 jeep       wrangler               255
4 nissan     pathfinder               0
5 toyota     camry                  104
6 volkswagen jetta                  160</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>plotly_obj <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sentiment_scores, <span class="fu">aes</span>(<span class="at">x =</span> Company, <span class="at">y =</span> sentiment_score, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sentiment Analysis of Car Reviews"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Company"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sentiment Score"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ggplot object to plotly</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>plotly_obj <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plotly_obj)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the interactive plot</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>plotly_obj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5836e7c637d009b48cfa" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5836e7c637d009b48cfa">{"x":{"data":[{"orientation":"v","width":0.90000000000000013,"base":-126,"x":[2],"y":[126],"text":"Company: honda<br />sentiment_score: 126<br />Model: accord","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"accord","legendgroup":"accord","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[5],"y":[104],"text":"Company: toyota<br />sentiment_score: 104<br />Model: camry","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"camry","legendgroup":"camry","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[160],"text":"Company: volkswagen<br />sentiment_score: 160<br />Model: jetta","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"jetta","legendgroup":"jetta","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999991,"base":0,"x":[1],"y":[51],"text":"Company: chevrolet<br />sentiment_score:  51<br />Model: malibu","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"malibu","legendgroup":"malibu","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0],"text":"Company: nissan<br />sentiment_score:   0<br />Model: pathfinder","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"pathfinder","legendgroup":"pathfinder","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[255],"text":"Company: jeep<br />sentiment_score: 255<br />Model: wrangler","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"wrangler","legendgroup":"wrangler","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":59.804955726331045,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Sentiment Analysis of Car Reviews","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,6.5999999999999996],"tickmode":"array","ticktext":["chevrolet","honda","jeep","nissan","toyota","volkswagen"],"tickvals":[1,2,3,3.9999999999999996,5,6],"categoryorder":"array","categoryarray":["chevrolet","honda","jeep","nissan","toyota","volkswagen"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Company","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-145.05000000000001,274.05000000000001],"tickmode":"array","ticktext":["-100","0","100","200"],"tickvals":[-100,0,100.00000000000003,200],"categoryorder":"array","categoryarray":["-100","0","100","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Sentiment Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Model","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c884d9b1132":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"4c884d9b1132","visdat":{"4c884d9b1132":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here’s an explanation of the output:</p>
<ol type="1">
<li><p><strong>Company:</strong> This column represents the name of the car company associated with the respective car model.</p></li>
<li><p><strong>Model:</strong> This column denotes the specific car model for which the sentiment score was calculated.</p></li>
<li><p><strong>Sentiment Score:</strong> This column displays the sentiment score assigned to each car model based on the reviews. The sentiment score indicates the overall sentiment expressed in the reviews for that particular car model.</p>
<ul>
<li><p>A positive score indicates a generally positive sentiment expressed in the reviews.</p></li>
<li><p>A negative score indicates a generally negative sentiment expressed in the reviews.</p></li>
<li><p>A score of zero suggests a neutral sentiment or an equal balance of positive and negative sentiments in the reviews.</p></li>
</ul></li>
</ol>
<p>Based on the sentiment scores provided in the output:</p>
<ul>
<li><p><strong>Chevrolet Malibu:</strong> The reviews for this model have a sentiment score of 51, indicating a somewhat positive sentiment overall.</p></li>
<li><p><strong>Honda Accord:</strong> The sentiment score for this model is -126, suggesting a predominantly negative sentiment in the reviews.</p></li>
<li><p><strong>Jeep Wrangler:</strong> This model has a sentiment score of 255, indicating a highly positive sentiment in the reviews.</p></li>
<li><p><strong>Nissan Pathfinder:</strong> The sentiment score is 0, suggesting a neutral sentiment or an equal balance of positive and negative sentiments in the reviews.</p></li>
<li><p><strong>Toyota Camry:</strong> The sentiment score for this model is 104, indicating a relatively positive sentiment in the reviews.</p></li>
<li><p><strong>Volkswagen Jetta:</strong> This model has a sentiment score of 160, suggesting a highly positive sentiment in the reviews.</p></li>
</ul>
<p>The analysis provides insights into how customers perceive different car models from various companies based on the sentiment expressed in their reviews. Positive sentiment scores indicate that customers generally view the respective car models positively, while negative sentiment scores suggest a negative perception.</p>
</section>
<section id="word-cloud" class="level2">
<h2 class="anchored" data-anchor-id="word-cloud">Word Cloud</h2>
<p>The code provided conducts text processing and analysis to generate a word cloud depicting the frequency of incident types derived from the dataset. Initially, the incident type data is extracted and preprocessed to ensure consistency and accuracy. Subsequently, a term-document matrix is created to represent the text data in a structured format. This matrix is then used to calculate word frequencies, identifying the most common incident types. Finally, the <strong><code>wordcloud</code></strong> function is employed to generate a visual representation of these frequencies, with larger and bolder words indicating higher occurrence. This word cloud serves as a concise yet informative summary, facilitating quick insights into the prevalent incident types within the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the required packages</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("wordcloud")</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'wordcloud' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: RColorBrewer</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("RColorBrewer")</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(tm)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector containing only the text</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> result<span class="sc">$</span>incident_type  <span class="co"># Replace "Description" with the name of your desired text column</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a corpus  </span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(text))</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dplyr package</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> docs <span class="sc">%&gt;%</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_map</span>(removeNumbers) <span class="sc">%&gt;%</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_map</span>(removePunctuation) <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_map</span>(stripWhitespace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(., removeNumbers): transformation drops
documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(., removePunctuation): transformation drops
documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(., stripWhitespace): transformation drops
documents</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(docs, <span class="fu">content_transformer</span>(tolower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(docs, content_transformer(tolower)):
transformation drops documents</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(docs, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(docs, removeWords, stopwords("english")):
transformation drops documents</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(docs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;SimpleCorpus&gt;&gt;
Metadata:  corpus specific: 1, document level (indexed): 0
Content:  documents: 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">TermDocumentMatrix</span>(docs) </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm) </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rowSums</span>(matrix),<span class="at">decreasing=</span><span class="cn">TRUE</span>) </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">word =</span> <span class="fu">names</span>(words),<span class="at">freq=</span>words)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the wordcloud package</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the word cloud</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the word cloud with adjusted scale parameter</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(<span class="at">words =</span> df<span class="sc">$</span>word, <span class="at">freq =</span> df<span class="sc">$</span>freq, <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">max.words =</span> <span class="dv">50</span>, <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">rot.per =</span> <span class="fl">0.35</span>, <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>), <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">1.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment-3_23102262_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the word cloud generated from the incident types, the most frequent words are:</p>
<ol type="1">
<li><p><strong>Collision</strong></p></li>
<li><p><strong>Vehicle</strong></p></li>
<li><p><strong>Theft</strong></p></li>
<li><p><strong>Car Parked</strong></p></li>
</ol>
<p>These words represent the most common incident types mentioned in the dataset, with “Collision” being the most prevalent. The word cloud provides a visual representation of the frequency of occurrence of these incident types, with larger and bolder words indicating higher frequencies.</p>
<p>The priority of incident types can be inferred based on their frequency in the dataset. In this case, “Collision” appears to be the most frequent incident type, followed by “Vehicle,” “Theft,” and “Car Parked.” This suggests that collisions are the most common type of incident recorded in the dataset, followed by incidents related to vehicles, theft, and parked cars, respectively.</p>
</section>
<section id="geographical-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="geographical-data-analysis">Geographical data analysis</h2>
<p>We conducted geoplotting to visualize the locations of incidents recorded in the insurance claim data. Leveraging the city and state information provided in the dataset, we approximated the latitude and longitude coordinates for each incident location. These coordinates were then utilized to pinpoint the exact city of the incidents on a dynamic map. By employing the Leaflet library in R, we accurately marked each incident location on the map, providing a comprehensive geographical representation of the insurance claim data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load ggmap package</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggmap")</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggmap' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Google's Terms of Service: &lt;https://mapsplatform.google.com&gt;
  Stadia Maps' Terms of Service: &lt;https://stadiamaps.com/terms-of-service/&gt;
  OpenStreetMap's Tile Usage Policy: &lt;https://operations.osmfoundation.org/policies/tiles/&gt;
ℹ Please cite ggmap if you use it! Use `citation("ggmap")` for details.

Attaching package: 'ggmap'


The following object is masked from 'package:plotly':

    wind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("osmdata")</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'osmdata' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tmaptools")</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmaptools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tmaptools' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine city and state columns into a unique address string in the result dataset</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>addresses <span class="ot">&lt;-</span> <span class="fu">paste</span>(result<span class="sc">$</span>incident_city, result<span class="sc">$</span>incident_state, <span class="at">sep =</span> <span class="st">", "</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Geocode addresses using the OSM Nominatim API</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>geocoded <span class="ot">&lt;-</span> <span class="fu">geocode_OSM</span>(addresses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No results found for "North Bend, NY".
No results found for "North Bend, NY".
No results found for "North Bend, NY".</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column in result for the address</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>address <span class="ot">&lt;-</span> <span class="fu">paste</span>(result<span class="sc">$</span>incident_city, result<span class="sc">$</span>incident_state, <span class="at">sep =</span> <span class="st">", "</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns in geocoded dataset to match result dataset</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns in geocoded dataset to match result dataset</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>geocoded <span class="ot">&lt;-</span> geocoded <span class="sc">%&gt;%</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">incident_address =</span> query)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform inner join based on incident_address</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>result_with_geo <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(result, geocoded, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"address"</span> <span class="ot">=</span> <span class="st">"incident_address"</span>), <span class="at">relationship =</span>  <span class="st">"many-to-many"</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting data set</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_with_geo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 65
  Car_id      Date.x              Gender Annual_Income Dealer_Name Company Model
  &lt;chr&gt;       &lt;dttm&gt;              &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;
1 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
2 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
3 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
4 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
5 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
6 C_CND_0006… 2022-01-03 00:00:00 Male          900000 Suburban F… nissan  path…
# ℹ 58 more variables: Engine &lt;chr&gt;, Transmission &lt;chr&gt;, Color &lt;chr&gt;,
#   Price &lt;dbl&gt;, Dealer_No &lt;chr&gt;, Body_Style &lt;chr&gt;, Phone &lt;dbl&gt;,
#   Dealer_Region &lt;chr&gt;, Year &lt;dbl&gt;, Reviewer &lt;chr&gt;, Date.y &lt;chr&gt;, Title &lt;chr&gt;,
#   Rating &lt;dbl&gt;, Review &lt;chr&gt;, months_as_customer &lt;int&gt;, age &lt;int&gt;,
#   policy_number &lt;int&gt;, policy_bind_date &lt;chr&gt;, policy_state &lt;chr&gt;,
#   policy_csl &lt;chr&gt;, policy_deductable &lt;int&gt;, policy_annual_premium &lt;dbl&gt;,
#   umbrella_limit &lt;int&gt;, insured_zip &lt;int&gt;, insured_sex &lt;chr&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"leaflet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/welcome/AppData/Local/R/win-library/4.3'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'leaflet' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\welcome\AppData\Local\Temp\RtmpGioq6t\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'leaflet' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>result_with_geo<span class="sc">$</span>latitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_with_geo<span class="sc">$</span>lat)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>result_with_geo<span class="sc">$</span>longitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_with_geo<span class="sc">$</span>lon)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Leaflet map with adjusted zoom level</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(<span class="at">data =</span> result_with_geo) <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng =</span> <span class="sc">~</span>longitude, <span class="at">lat =</span> <span class="sc">~</span>latitude, <span class="at">popup =</span> <span class="sc">~</span>incident_location) <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fu">mean</span>(result_with_geo<span class="sc">$</span>longitude), <span class="at">lat =</span> <span class="fu">mean</span>(result_with_geo<span class="sc">$</span>latitude), <span class="at">zoom =</span> <span class="dv">5</span>)  <span class="co"># Adjust zoom level as needed</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the map</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-459357a7024680dda294" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-459357a7024680dda294">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,39.9807706,39.9807706,39.9807706,34.2814497,41.625703,41.625703,39.2460871,32.7957844,32.7957844,32.7957844,33.2412288,33.2412288,43.4065089,43.4065089,43.4065089,43.4065089,39.9203866,37.449886,37.449886,37.449886,39.6370261,39.6370261,39.6370261,39.6370261,43.4065089,43.4065089,43.4065089,43.4065089,39.9807706,39.9807706,39.9807706,38.2298375,38.2298375,38.2298375,38.2298375,39.3862076,39.3862076,39.9234046,39.9234046,32.7957844,32.7957844,32.7957844,33.4968163,33.4968163,33.4968163,33.4968163,35.5934945,35.5934945,35.5934945,39.9306677,39.9306677,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,43.4065089,43.4065089,43.4065089,43.4065089,35.6906264,35.6906264,35.0195648,35.0195648,35.0195648,35.0195648,35.0195648,34.2734843,34.2734843,34.2734843,38.2298375,38.2298375,38.2298375,38.2298375,34.1212627,34.1212627,39.6370261,39.6370261,39.6370261,39.6370261,38.7791227,38.7791227,42.6839611,42.6839611,42.6839611,42.6839611,39.4506494,39.4506494,35.0195648,35.0195648,35.0195648,35.0195648,35.0195648,39.3862076,39.3862076,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,39.6370261,39.6370261,39.6370261,39.6370261,36.7261454,41.3500672,41.3500672,41.3500672,37.449886,37.449886,37.449886,41.6958008,41.6958008,41.6958008,41.6958008,41.6958008,35.0195648,35.0195648,35.0195648,35.0195648,35.0195648,39.9234046,39.9234046,32.7957844,32.7957844,32.7957844,33.4968163,33.4968163,33.4968163,33.4968163,35.5934945,35.5934945,35.5934945,39.9306677,39.9306677,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,43.4065089,43.4065089,43.4065089,43.4065089,35.6906264,35.6906264,35.0195648,35.0195648,35.0195648,35.0195648,35.0195648,35.3160037,35.3160037,35.9329145,35.9329145,35.0195648,35.0195648,35.0195648,35.0195648,35.0195648,42.6839611,42.6839611,42.6839611,42.6839611,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,35.2693066,42.6839611,42.6839611,42.6839611,42.6839611,42.6839611,42.6839611,42.6839611,42.6839611,35.9329145,35.9329145,41.625703,41.625703,37.449886,37.449886,37.449886,41.3500672,41.3500672,41.3500672,33.4968163,33.4968163,33.4968163,33.4968163,38.800011,38.800011,38.800011,38.800011,40.4151786,41.6958008,41.6958008,41.6958008,41.6958008,41.6958008,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,39.4506494,39.4506494,33.4968163,33.4968163,33.4968163,33.4968163,38.8903961,34.2734843,34.2734843,34.2734843,33.2412288,33.2412288,34.2734843,34.2734843,34.2734843,41.6958008,41.6958008,41.6958008,41.6958008,41.6958008,43.3443324,38.7791227,38.7791227,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,35.3160037,35.3160037,38.2298375,38.2298375,38.2298375,38.2298375,34.1212627,34.1212627,39.9807706,39.9807706,39.9807706,41.6958008,41.6958008,41.6958008,41.6958008,41.6958008,41.3500672,41.3500672,41.3500672,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,39.9622601,38.7048378,42.1789784,42.1789784,42.1789784,42.1789784,42.1789784,38.2298375,38.2298375,38.2298375,38.2298375,35.5934945,35.5934945,35.5934945,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,42.8361841,41.6958008,41.6958008,41.6958008,41.6958008,41.6958008,39.6370261,39.6370261,39.6370261,39.6370261],[-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-82.90957400000001,-82.90957400000001,-82.90957400000001,-78.66659300000001,-73.960346,-73.960346,-84.5814785,-79.9299463,-79.9299463,-79.9299463,-87.5419505,-87.5419505,-124.2242824,-124.2242824,-124.2242824,-124.2242824,-75.6888266,-81.70396479999999,-81.70396479999999,-81.70396479999999,-79.9779348,-79.9779348,-79.9779348,-79.9779348,-124.2242824,-124.2242824,-124.2242824,-124.2242824,-82.90957400000001,-82.90957400000001,-82.90957400000001,-80.4431372,-80.4431372,-80.4431372,-80.4431372,-78.5994881,-78.5994881,-83.81013799999999,-83.81013799999999,-79.9299463,-79.9299463,-79.9299463,-81.2792711,-81.2792711,-81.2792711,-81.2792711,-77.3944099,-77.3944099,-77.3944099,-75.32018789999999,-75.32018789999999,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-124.2242824,-124.2242824,-124.2242824,-124.2242824,-78.429813,-78.429813,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-80.591745,-80.591745,-80.591745,-80.4431372,-80.4431372,-80.4431372,-80.4431372,-81.04675760000001,-81.04675760000001,-79.9779348,-79.9779348,-79.9779348,-79.9779348,-77.1861196,-77.1861196,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-78.69362719999999,-78.69362719999999,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-78.5994881,-78.5994881,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-79.9779348,-79.9779348,-79.9779348,-79.9779348,-76.6323714,-77.702208,-77.702208,-77.702208,-81.70396479999999,-81.70396479999999,-81.70396479999999,-73.89649,-73.89649,-73.89649,-73.89649,-73.89649,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-83.81013799999999,-83.81013799999999,-79.9299463,-79.9299463,-79.9299463,-81.2792711,-81.2792711,-81.2792711,-81.2792711,-77.3944099,-77.3944099,-77.3944099,-75.32018789999999,-75.32018789999999,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-124.2242824,-124.2242824,-124.2242824,-124.2242824,-78.429813,-78.429813,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-80.95125040000001,-80.95125040000001,-79.98726139999999,-79.98726139999999,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-81.9539942,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-80.9725736,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-75.3726723,-79.98726139999999,-79.98726139999999,-73.960346,-73.960346,-81.70396479999999,-81.70396479999999,-81.70396479999999,-77.702208,-77.702208,-77.702208,-81.2792711,-81.2792711,-81.2792711,-81.2792711,-80.3431526,-80.3431526,-80.3431526,-80.3431526,-79.97001830000001,-73.89649,-73.89649,-73.89649,-73.89649,-73.89649,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-78.69362719999999,-78.69362719999999,-81.2792711,-81.2792711,-81.2792711,-81.2792711,-77.0841585,-80.591745,-80.591745,-80.591745,-87.5419505,-87.5419505,-80.591745,-80.591745,-80.591745,-73.89649,-73.89649,-73.89649,-73.89649,-73.89649,-73.6470806,-77.1861196,-77.1861196,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-80.95125040000001,-80.95125040000001,-80.4431372,-80.4431372,-80.4431372,-80.4431372,-81.04675760000001,-81.04675760000001,-82.90957400000001,-82.90957400000001,-82.90957400000001,-73.89649,-73.89649,-73.89649,-73.89649,-73.89649,-77.702208,-77.702208,-77.702208,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-83.00070650000001,-77.09525600000001,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-73.5259511,-80.4431372,-80.4431372,-80.4431372,-80.4431372,-77.3944099,-77.3944099,-77.3944099,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-74.85348380000001,-73.89649,-73.89649,-73.89649,-73.89649,-73.89649,-79.9779348,-79.9779348,-79.9779348,-79.9779348],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["5846 Weaver Drive","5846 Weaver Drive","5846 Weaver Drive","5846 Weaver Drive","5846 Weaver Drive","5846 Weaver Drive","8101 3rd Ridge","8101 3rd Ridge","8101 3rd Ridge","3422 Flute St","5104 Francis Drive","5104 Francis Drive","3289 Britain Drive","3743 Andromedia Ridge","3743 Andromedia Ridge","3743 Andromedia Ridge","2539 Embaracadero Ridge","2539 Embaracadero Ridge","9980 Lincoln Ave","9980 Lincoln Ave","9980 Lincoln Ave","9980 Lincoln Ave","4158 Washington Lane","8906 Elm Lane","8906 Elm Lane","8906 Elm Lane","7615 Weaver Drive","7615 Weaver Drive","7615 Weaver Drive","7615 Weaver Drive","2668 Cherokee St","2668 Cherokee St","2668 Cherokee St","2668 Cherokee St","3805 Lincoln Hwy","3805 Lincoln Hwy","3805 Lincoln Hwy","4554 Sky Ave","4554 Sky Ave","4554 Sky Ave","4554 Sky Ave","7041 Tree Ridge","7041 Tree Ridge","7459 Flute St","7459 Flute St","7238 2nd St","7238 2nd St","7238 2nd St","9484 Pine Drive","9484 Pine Drive","9484 Pine Drive","9484 Pine Drive","6493 Lincoln Lane","6493 Lincoln Lane","6493 Lincoln Lane","5778 Pine Ridge","5778 Pine Ridge","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","3495 Britain Drive","3495 Britain Drive","3495 Britain Drive","3495 Britain Drive","1617 Rock Drive","1617 Rock Drive","8983 Tree St","8983 Tree St","8983 Tree St","8983 Tree St","8983 Tree St","8006 Maple Hwy","8006 Maple Hwy","8006 Maple Hwy","7773 Tree Hwy","7773 Tree Hwy","7773 Tree Hwy","7773 Tree Hwy","9316 Pine Ave","9316 Pine Ave","7684 Francis Ridge","7684 Francis Ridge","7684 Francis Ridge","7684 Francis Ridge","9748 Sky Drive","9748 Sky Drive","6104 Oak Ave","6104 Oak Ave","6104 Oak Ave","6104 Oak Ave","9744 Texas Drive","9744 Texas Drive","6985 Maple Lane","6985 Maple Lane","6985 Maple Lane","6985 Maple Lane","6985 Maple Lane","6309 Cherokee Ave","6309 Cherokee Ave","6874 Maple Ridge","6874 Maple Ridge","6874 Maple Ridge","6874 Maple Ridge","6874 Maple Ridge","6874 Maple Ridge","8542 Lincoln Ridge","8542 Lincoln Ridge","8542 Lincoln Ridge","8542 Lincoln Ridge","6390 Apache St","2494 Andromedia Drive","2494 Andromedia Drive","2494 Andromedia Drive","1929 Britain Drive","1929 Britain Drive","1929 Britain Drive","6838 Flute Lane","6838 Flute Lane","6838 Flute Lane","6838 Flute Lane","6838 Flute Lane","9488 Best Drive","9488 Best Drive","9488 Best Drive","9488 Best Drive","9488 Best Drive","7459 Flute St","7459 Flute St","7238 2nd St","7238 2nd St","7238 2nd St","9484 Pine Drive","9484 Pine Drive","9484 Pine Drive","9484 Pine Drive","6493 Lincoln Lane","6493 Lincoln Lane","6493 Lincoln Lane","5778 Pine Ridge","5778 Pine Ridge","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","8188 Tree Ave","3495 Britain Drive","3495 Britain Drive","3495 Britain Drive","3495 Britain Drive","1617 Rock Drive","1617 Rock Drive","8983 Tree St","8983 Tree St","8983 Tree St","8983 Tree St","8983 Tree St","7098 Lincoln Hwy","7098 Lincoln Hwy","9358 Texas Ridge","9358 Texas Ridge","5532 Weaver Ridge","5532 Weaver Ridge","5532 Weaver Ridge","5532 Weaver Ridge","5532 Weaver Ridge","1562 Britain St","1562 Britain St","1562 Britain St","1562 Britain St","1815 Cherokee Drive","1815 Cherokee Drive","1815 Cherokee Drive","1815 Cherokee Drive","1815 Cherokee Drive","3936 Tree Drive","4119 Texas St","4119 Texas St","4119 Texas St","4119 Texas St","6409 Cherokee Drive","6409 Cherokee Drive","6409 Cherokee Drive","6409 Cherokee Drive","6957 Weaver Drive","6957 Weaver Drive","5051 Elm St","5051 Elm St","6583 MLK Ridge","6583 MLK Ridge","6583 MLK Ridge","8021 Flute Ave","8021 Flute Ave","8021 Flute Ave","4414 Solo Drive","4414 Solo Drive","4414 Solo Drive","4414 Solo Drive","9794 Embaracadero St","9794 Embaracadero St","4872 Rock Ridge","4872 Rock Ridge","2533 Elm St","9034 Weaver Ridge","9034 Weaver Ridge","9034 Weaver Ridge","9034 Weaver Ridge","9034 Weaver Ridge","7705 Best Ridge","7705 Best Ridge","7705 Best Ridge","7705 Best Ridge","7705 Best Ridge","7705 Best Ridge","3654 Cherokee Ave","3654 Cherokee Ave","4058 Tree Drive","4058 Tree Drive","4058 Tree Drive","4058 Tree Drive","4347 2nd Ridge","1919 4th Lane","1919 4th Lane","1919 4th Lane","2774 Apache Drive","2774 Apache Drive","3903 Oak Ave","3903 Oak Ave","3903 Oak Ave","2048 3rd Ridge","2048 3rd Ridge","2048 3rd Ridge","2048 3rd Ridge","2048 3rd Ridge","9293 Pine Lane","7240 5th Ridge","7240 5th Ridge","3930 Embaracadero St","3930 Embaracadero St","3930 Embaracadero St","3930 Embaracadero St","3930 Embaracadero St","1598 3rd Drive","1598 3rd Drive","1598 3rd Drive","1598 3rd Drive","1598 3rd Drive","1536 Flute Drive","1536 Flute Drive","6375 2nd Lane","6375 2nd Lane","6375 2nd Lane","6375 2nd Lane","8718 Apache Lane","8718 Apache Lane","5506 Best St","5506 Best St","5506 Best St","2318 Washington Hwy","2318 Washington Hwy","2318 Washington Hwy","2318 Washington Hwy","2318 Washington Hwy","4618 Flute Ave","4618 Flute Ave","4618 Flute Ave","6770 1st St","6770 1st St","6770 1st St","6770 1st St","6770 1st St","2651 MLK Lane","9067 Texas Ave","9910 Maple Ave","9910 Maple Ave","9910 Maple Ave","9910 Maple Ave","9910 Maple Ave","5765 Washington St","5765 Washington St","5765 Washington St","5765 Washington St","7909 Andromedia Hwy","7909 Andromedia Hwy","7909 Andromedia Hwy","2850 Washington St","2850 Washington St","2850 Washington St","2850 Washington St","2850 Washington St","2850 Washington St","2086 Francis Drive","2086 Francis Drive","2086 Francis Drive","2086 Francis Drive","2086 Francis Drive","9821 Francis Ave","9821 Francis Ave","9821 Francis Ave","9821 Francis Ave"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[32.7957844,43.4065089],"lng":[-124.2242824,-73.5259511]},"setView":[[39.14940791353136,-80.60329745313531],5,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="mermaid-code" class="level2">
<h2 class="anchored" data-anchor-id="mermaid-code">Mermaid Code:</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    subgraph "Car_Sales Dataset"
        Car_Sales --&gt; Merged_Dataset
    end
    subgraph "Insurance Dataset"
        Insurance --&gt; Merged_Dataset
    end
    subgraph "Review Dataset"
        Review --&gt; Merged_Dataset
    end
    Merged_Dataset --&gt; Analysis

</pre>
</div>
</div>
</div>
</div>
<p>This Mermaid flowchart describes the merging of multiple datasets into one combined dataset and then the subsequent analysis performed on the merged dataset.</p>
<ol type="1">
<li><p>The “Car_Sales Dataset”, “Insurance Dataset”, and “Review Dataset” are represented as separate subgraphs, indicating the individual datasets.</p></li>
<li><p>Each dataset is connected to the “Merged_Dataset” node, signifying the merging of these datasets into one combined dataset.</p></li>
<li><p>Finally, the “Merged_Dataset” node is linked to the “Analysis” node, indicating that various analyses or operations are performed on the merged dataset.</p></li>
</ol>
<p>Overall, the flowchart provides a visual representation of the process of merging multiple datasets and performing analysis on the combined dataset.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>